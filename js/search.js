var searchFunc=function(e,n,s){"use strict";$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),e=document.getElementById(n),r=document.getElementById(s);e.addEventListener("input",function(){var p='<ul class="search-result-list">',d=this.value.trim().toLowerCase().split(/[\s\-]+/);r.innerHTML="暂无搜索结果",this.value.trim().length<=0||(t.forEach(function(e){var r,t,n,s,a=!0,c=e.title.trim().toLowerCase(),u=c.replace(" ","-"),i=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),l=e.url,o=-1,h=-1;""!=c&&""!=i&&d.forEach(function(e,t){r=c.indexOf(e),o=i.indexOf(e),r<0&&o<0?a=!1:(o<0&&(o=0),0==t&&(h=o))}),a&&(e=e.content.trim().replace(/<[^>]+>/g,""),0<=h)&&(n=h+6,(n=0==(t=(t=h-6)<0?0:t)?10:n)>e.length&&(n=e.length),s=e.substr(t,n),d.forEach(function(e){var t=new RegExp(e,"gi");s=s.replace(t,'<span class="search-keyword">'+e+"</span>"),c=c.replace(t,'<span class="search-keyword">'+e+"</span>")}),p+="<li><a href='"+l+"' class='search-result-title'>"+c+"</a>",e=l.replace("/"+u+"/",""),p=p+'<span id="search-result-time">更新于 '+e+'<span><p class="search-result">'+s+"...</p>")}),r.innerHTML=p)})}})},inputArea=document.querySelector("#search-input"),$resultArea=$("#search-result");inputArea.onfocus=function(){searchFunc("/search.xml","search-input","search-result")},inputArea.onkeydown=function(){if(13==event.keyCode)return!1},resetSearch=function(){$resultArea.html(""),$(".no-result").hide()},$resultArea.bind("DOMNodeRemoved DOMNodeInserted",function(e){$(e.target).text()?$(".no-result").hide():$(".no-result").show(200)});